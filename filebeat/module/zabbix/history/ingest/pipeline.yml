---
description: Pipeline for parsing zabbix history logs
processors:
  - rename:
      field: "@timestamp"
      target_field: event.created
  - rename:
      field: json
      target_field: zabbix.history
  - date:
      field: zabbix.history.clock
      target_field: "@timestamp"
      formats:
        - UNIX
      ignore_failure: true
  - rename:
      field: zabbix.history.value
      target_field: zabbix.history.value.text
  - set:
      field: zabbix.history.value.keyword
      value: "{{ zabbix.history.value.text }}"
  - convert:
      field: zabbix.history.value.text
      target_field: zabbix.history.value.double
      type: double
  - convert:
      field: zabbix.history.value.text
      target_field: zabbix.history.value.long
      type: long
on_failure:
- set:
    field: error.message
    value: "{{ _ingest.on_failure_message }}"
...
